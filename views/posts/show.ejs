<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

</head>

<body>

    <h1>
        <%=post.title%>
    </h1>

    <h3>
        <%=post.content %>
    </h3>

    <h5>Author---<%=post.author %>
    </h5>

    <h3 id="displayLike">
        <%= post.likes.length %>
    </h3> <button id="likeButton">Like</button>

    <button id="saveButton">
        <%= saveButtonText %>
    </button>

    <button id="followButton">follow</button>

    <h1>comments</h1>
    <input type="text" id="commentInput">
    <button id="commentSubmit">Submit</button>
    <ul id="commentsList">
        <% for(let comment of comments) { %>
            <li>
                <%= comment.comment %>--by <%= comment.user.name %>
                        <button class="deleteCommentButton" data-comment-id=<%=comment._id%>
                            >Delete</button>

            </li>
            <% } %>
    </ul>
</body>
<script>
    const postId = '<%=post._id%>';
    const owner = '<%=post.owner%>'
    // console.log(owner)
    const followButton = document.querySelector('#followButton')
    followButton.addEventListener('click', () => {
        console.log('clicked');
        fetch(`/user/${owner}/follow`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({})
        }).then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
            .then(data => {
                console.log('Fetch successful:', data);
                console.log(data);
                if (data === 'followed') {
                    followButton.innerHTML = 'unfollow';
                } else if (data === 'unfollowed') {
                    followButton.innerHTML = 'follow';
                }
            })
            .catch(error => {
                console.error('There was a problem with the fetch operation:', error);
            });
    })



</script>
<script src="/scripts/addComments.js"></script>
<script src="/scripts/deleteComments.js"></script>
<script src="/scripts/likes.js"></script>
<script src="/scripts/saved.js"></script>

</html>